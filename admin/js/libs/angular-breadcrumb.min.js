!function(e,t,r){"use strict";function a(e,r){return t.equals(e.length,r.length)?e>r:e.length>r.length}function n(e){var t=e.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/);if(!t||4!==t.length)throw new Error("Invalid state ref '"+e+"'");return{state:t[1],paramExpr:t[3]||null}}function c(e,t,a,n){var c=l[e];c!==r&&c(),c=t.$on(a,n),l[e]=c}function u(){var e={prefixStateName:null,template:"bootstrap3",templateUrl:null,templateLast:"default",templateLastUrl:null,includeAbstract:!1};this.setOptions=function(r){t.extend(e,r)},this.$get=["$state","$stateParams","$rootScope",function(t,u,i){var o=i;c("$Breadcrumb.$viewContentLoaded",i,"$viewContentLoaded",function(e){!e.targetScope.ncyBreadcrumbIgnore&&a(e.targetScope.$id,o.$id)&&(o=e.targetScope)});var s=function(e){var t=e.parent||(/^(.+)\.[^.]+$/.exec(e.name)||[])[1];return"object"==typeof t?t.name:t},l=function(r,a){for(var c,i,s=n(a),l=!1,p=!1,m=0,d=r.length;m<d;m+=1)if(r[m].name===s.state)return;c=t.get(s.state),c.ncyBreadcrumb&&(c.ncyBreadcrumb.force&&(l=!0),c.ncyBreadcrumb.skip&&(p=!0)),c.abstract&&!e.includeAbstract&&!l||p||(s.paramExpr&&(i=o.$eval(s.paramExpr)),c.ncyBreadcrumbLink=t.href(s.state,i||u||{}),c.ncyBreadcrumbStateRef=a,r.unshift(c))},p=function(e){var r=n(e),a=t.get(r.state);if(a.ncyBreadcrumb&&a.ncyBreadcrumb.parent){var c="function"==typeof a.ncyBreadcrumb.parent,u=c?a.ncyBreadcrumb.parent(o):a.ncyBreadcrumb.parent;if(u)return u}return s(a)};return{getTemplate:function(t){return e.templateUrl?null:t[e.template]?t[e.template]:e.template},getTemplateUrl:function(){return e.templateUrl},getTemplateLast:function(t){return e.templateLastUrl?null:t[e.templateLast]?t[e.templateLast]:e.templateLast},getTemplateLastUrl:function(){return e.templateLastUrl},getStatesChain:function(r){for(var a=[],n=t.$current.self.name;n;n=p(n))if(l(a,n),r&&a.length)return a;return e.prefixStateName&&l(a,e.prefixStateName),a},getLastStep:function(){var e=this.getStatesChain(!0);return e.length?e[0]:r},$getLastViewScope:function(){return o}}}]}function i(e,r,a){var n={bootstrap2:'<ul class="breadcrumb"><li ng-repeat="step in steps" ng-switch="$last || !!step.abstract" ng-class="{active: $last}"><a ng-switch-when="false" href="{{step.ncyBreadcrumbLink}}">{{step.ncyBreadcrumbLabel}}</a><span ng-switch-when="true">{{step.ncyBreadcrumbLabel}}</span><span class="divider" ng-hide="$last">/</span></li></ul>',bootstrap3:'<ol class="breadcrumb"><li ng-repeat="step in steps" ng-class="{active: $last}" ng-switch="$last || !!step.abstract"><a ng-switch-when="false" href="{{step.ncyBreadcrumbLink}}">{{step.ncyBreadcrumbLabel}}</a><span ng-switch-when="true">{{step.ncyBreadcrumbLabel}}</span></li></ol>'};return{restrict:"AE",replace:!0,scope:{},template:r.getTemplate(n),templateUrl:r.getTemplateUrl(),link:{post:function(n){var u=[],i=function(){d(u),u=[];var a=r.$getLastViewScope();n.steps=r.getStatesChain(),t.forEach(n.steps,function(t){if(t.ncyBreadcrumb&&t.ncyBreadcrumb.label){var r=e(t.ncyBreadcrumb.label);t.ncyBreadcrumbLabel=r(a),m(u,r,a,t)}else t.ncyBreadcrumbLabel=t.name})};c("BreadcrumbDirective.$viewContentLoaded",a,"$viewContentLoaded",function(e){e.targetScope.ncyBreadcrumbIgnore||i()}),i()}}}}function o(e,t,r){var a={default:"{{ncyBreadcrumbLabel}}"};return{restrict:"A",scope:{},template:t.getTemplateLast(a),templateUrl:t.getTemplateLastUrl(),compile:function(a,n){var u=a.attr(n.$attr.ncyBreadcrumbLast);return u&&a.html(u),{post:function(a){var n=[],u=function(){d(n),n=[];var r=t.$getLastViewScope(),c=t.getLastStep();if(c)if(a.ncyBreadcrumbLink=c.ncyBreadcrumbLink,c.ncyBreadcrumb&&c.ncyBreadcrumb.label){var u=e(c.ncyBreadcrumb.label);a.ncyBreadcrumbLabel=u(r),m(n,u,r,a)}else a.ncyBreadcrumbLabel=c.name};c("BreadcrumbLastDirective.$viewContentLoaded",r,"$viewContentLoaded",function(e){e.targetScope.ncyBreadcrumbIgnore||u()}),u()}}}}}function s(e,r,a){return{restrict:"A",scope:{},template:"{{ncyBreadcrumbChain}}",compile:function(n,u){var i=n.attr(u.$attr.ncyBreadcrumbText);i&&n.html(i);var o=n.attr(u.$attr.ncyBreadcrumbTextSeparator)||" / ";return{post:function(n){var u=[],i=function(e,r,a){t.forEach(p(r),function(t){var r=a.$watch(t,function(e,t){e!==t&&s()});e.push(r)})},s=function(){d(u),u=[];var a=r.$getLastViewScope(),c=r.getStatesChain(),s=[];t.forEach(c,function(t){if(t.ncyBreadcrumb&&t.ncyBreadcrumb.label){var r=e(t.ncyBreadcrumb.label);s.push(r(a)),i(u,r,a)}else s.push(t.name)}),n.ncyBreadcrumbChain=s.join(o)};c("BreadcrumbTextDirective.$viewContentLoaded",a,"$viewContentLoaded",function(e){e.targetScope.ncyBreadcrumbIgnore||s()}),s()}}}}}var l={},p=function(e){if(e.expressions)return e.expressions;var r=[];return t.forEach(e.parts,function(e){t.isFunction(e)&&r.push(e.exp)}),r},m=function(e,r,a,n){t.forEach(p(r),function(t){var c=a.$watch(t,function(){n.ncyBreadcrumbLabel=r(a)});e.push(c)})},d=function(e){t.forEach(e,function(e){e()})};i.$inject=["$interpolate","$breadcrumb","$rootScope"],o.$inject=["$interpolate","$breadcrumb","$rootScope"],s.$inject=["$interpolate","$breadcrumb","$rootScope"],t.module("ncy-angular-breadcrumb",["ui.router.state"]).provider("$breadcrumb",u).directive("ncyBreadcrumb",i).directive("ncyBreadcrumbLast",o).directive("ncyBreadcrumbText",s)}(window,window.angular);